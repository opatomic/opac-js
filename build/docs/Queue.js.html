<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Queue.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Queue.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/**
 * @classdesc This class is not actually created. It is here to help with type checking.
 * @constructor
 * @extends Array
 * @hideconstructor
 */
function QChunk() {}
/** @type {QChunk} */
QChunk.prototype.next;
/** @type {number} */
QChunk.prototype.head;
/** @type {number} */
QChunk.prototype.used;

/**
 * Queue that allocates arrays in small chunks as needed. Chunks are stored as linked list.
 * This design is efficient because it does not require growing arrays and copying data when
 * capacity is exceeded. Also, large contiguous chunks of memory are not required.
 * If only 1 chunk is needed, then it is utilized as a circular array to avoid constantly
 * reallocating a new chunk.
 * @constructor
 * @template T
 */
function Queue() {
	/** @type {number} */
	this.totlen = 0;
	/** @type {!QChunk} */
	this.head = newQChunk(this.newChunkSize, null);
	/** @type {!QChunk} */
	this.tail = this.head;
}

/**
 * @ignore
 * @param {number} size - size of chunk's array
 * @param {QChunk} prev - link to previous chunk
 * @return {!QChunk}
 */
function newQChunk(size, prev) {
	var c = /** @type {!QChunk} */ (new Array(size));
	c.next = null;
	c.head = 0;
	c.used = 0;
	if (prev) {
		prev.next = c;
	}
	return c;
}

/**
 * Add the specified element to the tail of the queue
 * @param {T} item
 * @return {number} new length after adding item
 */
Queue.prototype.push = function(item) {
	var chunk = this.tail;
	if (chunk.used + 1 >= chunk.length) {
		this.tail = chunk = newQChunk(this.newChunkSize, chunk);
	}
	chunk[(chunk.head + chunk.used) &amp; (chunk.length - 1)] = item;
	chunk.used++;
	return ++this.totlen;
};

/**
 * Remove an item from the head of the queue
 * @return {T} The first item in the queue or undefined if queue is empty
 */
Queue.prototype.shift = function() {
	var chunk = this.head;
	if (chunk.used == 0) {
		return undefined;
	}
	var idx = chunk.head;
	var item = chunk[idx];
	chunk[idx] = undefined;
	chunk.used--;
	if (chunk.used == 0 &amp;&amp; chunk.next) {
		this.head = chunk.next;
	} else {
		chunk.head = (idx + 1) &amp; (chunk.length - 1);
	}
	this.totlen--;
	return item;
};

/**
 * @return {number}
 */
Queue.prototype.size = function() {
	return this.totlen;
};

/**
 * size of each new array chunk. must be greater than 0 and a power of 2!
 * @type {number}
 */
Queue.prototype.newChunkSize = 64;

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BigDec.html">BigDec</a></li><li><a href="EventClient.html">EventClient</a></li><li><a href="OpaDef.html">OpaDef</a></li><li><a href="PartialParser.html">PartialParser</a></li><li><a href="PartialParser.Buff.html">PartialParser.Buff</a></li><li><a href="QChunk.html">QChunk</a></li><li><a href="Queue.html">Queue</a></li><li><a href="Serializer.html">Serializer</a></li></ul><h3>Interfaces</h3><ul><li><a href="IWriter.html">IWriter</a></li></ul><h3>Global</h3><ul><li><a href="global.html#cacheString">cacheString</a></li><li><a href="global.html#opaType">opaType</a></li><li><a href="global.html#stringify">stringify</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Mon Jan 28 2019 14:17:43 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
